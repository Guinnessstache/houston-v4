{"remainingRequest":"/Users/davidaleksic/Sites/houston-v4/node_modules/babel-loader/lib/index.js!/Users/davidaleksic/Sites/houston-v4/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/davidaleksic/Sites/houston-v4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/davidaleksic/Sites/houston-v4/src/components/Withdraw.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/davidaleksic/Sites/houston-v4/src/components/Withdraw.vue","mtime":1577116137888},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/cache-loader/dist/cjs.js","mtime":1577116124352},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/babel-loader/lib/index.js","mtime":1577116124172},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/cache-loader/dist/cjs.js","mtime":1577116124352},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/vue-loader/lib/index.js","mtime":1577116128818}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/davidaleksic/Sites/houston-v4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  props: ['profileAddress', 'erc725'],\n  mounted: function mounted() {\n    var _this = this;\n\n    window.eth.accounts().then(function (result) {\n      // eslint-disable-next-line\n      _this.wallet = result[0];\n    });\n    window.EventBus.$on('management_wallet_changed', function (managementWallet) {\n      _this.wallet = managementWallet;\n    });\n  },\n  data: function data() {\n    return {\n      amount: 0,\n      wallet: ''\n    };\n  },\n  methods: {\n    startTokenWithdrawal: function startTokenWithdrawal() {\n      var _this2 = this;\n\n      this.$alert('This operation will require 2 transactions to blockchain. ', 'Important', {\n        confirmButtonText: 'OK',\n        callback: function callback() {\n          var profileContract = window.eth.contract(window.profileAbi).at(_this2.profileAddress);\n          profileContract.startTokenWithdrawal(_this2.erc725, _this2.prepareNumber(), {\n            from: _this2.wallet\n          }).then(\n          /*#__PURE__*/\n          function () {\n            var _ref = _asyncToGenerator(\n            /*#__PURE__*/\n            regeneratorRuntime.mark(function _callee(hash) {\n              var countDownDate, x;\n              return regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      window.EventBus.$emit('loading', 'First transaction in progress. Please wait.');\n                      _context.next = 3;\n                      return window.Utilities.getTransactionReceipt(hash);\n\n                    case 3:\n                      window.EventBus.$emit('loading-done');\n                      countDownDate = new Date().getTime() + 5 * 65 * 1000;\n                      x = setInterval(function () {\n                        window.EventBus.$emit('loading-done');\n                        var now = new Date().getTime();\n                        var distance = countDownDate - now;\n                        var minutes = Math.floor(distance % (1000 * 60 * 60) / (1000 * 60));\n                        var seconds = Math.floor(distance % (1000 * 60) / 1000);\n                        window.EventBus.$emit('loading', \"This operation will take another \".concat(minutes, \" minutes and \").concat(seconds, \" seconds. Please be patient and don't close the browser.\"));\n\n                        if (distance < 0) {\n                          clearInterval(x);\n                        }\n                      }, 1000);\n                      setTimeout(function () {\n                        window.EventBus.$emit('loading', 'Please approve second transaction');\n\n                        _this2.withdrawTokens();\n                      }, 5 * 65 * 1000);\n\n                    case 7:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, _callee, this);\n            }));\n\n            return function (_x) {\n              return _ref.apply(this, arguments);\n            };\n          }());\n        }\n      });\n    },\n    withdrawTokens: function withdrawTokens() {\n      var profileContract = window.eth.contract(window.profileAbi).at(this.profileAddress);\n      profileContract.withdrawTokens(this.erc725, {\n        from: this.wallet\n      }).then(\n      /*#__PURE__*/\n      function () {\n        var _ref2 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee2(hash) {\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  window.EventBus.$emit('loading', 'Second transaction in progress. Please wait.');\n                  _context2.next = 3;\n                  return window.Utilities.getTransactionReceipt(hash);\n\n                case 3:\n                  window.EventBus.$emit('loading-done');\n\n                case 4:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }));\n\n        return function (_x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    },\n    prepareNumber: function prepareNumber() {\n      var am = new window.Eth.BN(this.amount * 1000);\n      var base = new window.Eth.BN(10);\n      var exponent = new window.Eth.BN(15);\n      var multiply = base.pow(exponent);\n      return am.mul(multiply);\n    }\n  }\n};",{"version":3,"sources":["Withdraw.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"panel\">\n    <h1>Withdraw TRAC from Your Node<el-popover\n      placement=\"top-start\"\n      title=\"Withdraw TRAC\"\n      width=\"300\"\n      style=\"margin-left: 10px\"\n      trigger=\"hover\"\n      content=\"You can always withdraw the amount of unstaked (not locked in a running job) TRAC from your node profile. This process is performed in a two-step fashion, with a 5min delay between steps. This is needed to avoid certain race conditions within the system functioning. Withdrawing TRAC from your node profile will send the TRAC to your management wallet.\nThe maximum amount of TRAC safe to withdraw is shown in the left sidebar. Keep in mind that if you withdraw all TRAC available, your node will not be able to respond to new offers because it will not be able to stake TRAC for the job. We recommend to always have some unlocked TRAC on the profile so that your node can receive new jobs.\">\n      <i class=\"el-icon-info\" slot=\"reference\"></i>\n    </el-popover></h1>\n    <span>This will withdraw TRAC from your ODN node profile.</span>\n    <el-col :span=\"24\" class=\"second-radius\">\n      <div class=\"el-col field\">\n        <p class=\"label-p\">Depositing to the Following Operational Wallet:</p>\n        <p class=\"op-wallet\">SMART CONTRACT ADDRESS SHOULD BE HERE</p>\n      </div>\n    </el-col>\n    <el-form>\n      <p class=\"label-p\">Amount to Withdraw:</p>\n      <el-form-item>\n        <el-input-number v-model=\"amount\" :precision=\"3\" :step=\"0.01\" :min=\"0\"></el-input-number>\n      </el-form-item>\n      <el-form-item>\n        <p class=\"label-p\">Withdrawing to the following management wallet:</p>\n        <el-input v-model=\"wallet\" :disabled=\"true\"></el-input>\n      </el-form-item>\n      <el-button class=\"houston-btn\" style=\"width: 47%\" @click=\"startTokenWithdrawal\">START WITHDRAWAL</el-button>\n      <el-button class=\"houston-white-btn \" style=\"width: 47%\" @click=\"withdrawTokens\">FIMNISH WITHDRAWAL</el-button>\n    </el-form>\n  </div>\n</template>\n<script>\nexport default {\n  props: ['profileAddress', 'erc725'],\n  mounted() {\n    window.eth.accounts().then((result) => {\n      // eslint-disable-next-line\n      this.wallet = result[0];\n    });\n\n    window.EventBus.$on('management_wallet_changed', (managementWallet) => {\n      this.wallet = managementWallet;\n    });\n  },\n  data() {\n    return {\n      amount: 0,\n      wallet: '',\n    };\n  },\n  methods: {\n    startTokenWithdrawal() {\n      this.$alert('This operation will require 2 transactions to blockchain. ', 'Important', {\n        confirmButtonText: 'OK',\n        callback: () => {\n          const profileContract = window.eth.contract(window.profileAbi).at(this.profileAddress);\n          profileContract.startTokenWithdrawal(this.erc725, this.prepareNumber(),\n            { from: this.wallet })\n            .then(async (hash) => {\n              window.EventBus.$emit('loading', 'First transaction in progress. Please wait.');\n              await window.Utilities.getTransactionReceipt(hash);\n              window.EventBus.$emit('loading-done');\n              const countDownDate = new Date().getTime() + (5 * 65 * 1000);\n              const x = setInterval(() => {\n                window.EventBus.$emit('loading-done');\n                const now = new Date().getTime();\n                const distance = countDownDate - now;\n                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));\n                const seconds = Math.floor((distance % (1000 * 60)) / 1000);\n                window.EventBus.$emit('loading', `This operation will take another ${minutes} minutes and ${seconds} seconds. Please be patient and don't close the browser.`);\n                if (distance < 0) {\n                  clearInterval(x);\n                }\n              }, 1000);\n              setTimeout(() => {\n                window.EventBus.$emit('loading', 'Please approve second transaction');\n                this.withdrawTokens();\n              }, (5 * 65 * 1000));\n            });\n        },\n      });\n    },\n    withdrawTokens() {\n      const profileContract = window.eth.contract(window.profileAbi).at(this.profileAddress);\n      profileContract.withdrawTokens(this.erc725,\n        { from: this.wallet })\n        .then(async (hash) => {\n          window.EventBus.$emit('loading', 'Second transaction in progress. Please wait.');\n          await window.Utilities.getTransactionReceipt(hash);\n          window.EventBus.$emit('loading-done');\n        });\n    },\n    prepareNumber() {\n      const am = new window.Eth.BN(this.amount * 1000);\n      const base = new window.Eth.BN(10);\n      const exponent = new window.Eth.BN(15);\n      const multiply = base.pow(exponent);\n      return am.mul(multiply);\n    },\n  },\n};\n</script>\n\n<style scoped>\n  .block{\n    display: block;\n  }\n  .houston-btn{\n    color: #ffffff;\n  }\n  .houston-btn:hover{\n    color: #ffffff;\n    background-color: #1d2667;\n    transition: all .2s;\n  }\n  .houston-btn:focus{\n    color: #ffffff;\n    background-color: #1d2667;\n    transition: all .2s;\n  }\n  .which-token{\n    margin-left: 10px;\n    font-family: Roboto;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: normal;\n    letter-spacing: normal;\n    color: #131415;\n  }\n  .label-p{\n    opacity: 0.5;\n    font-family: Roboto;\n    font-size: 14px;\n    font-weight: normal;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: 1;\n    letter-spacing: normal;\n    margin-bottom: 10px;\n    color: #131415;\n  }\n\n  .op-wallet{\n    border-radius: 4px;\n    border: solid 1px #acacac;\n    background-color: #f6f6f6;\n    opacity: 0.5;\n    font-family: Roboto;\n    font-size: 14px;\n    font-weight: normal;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: 1;\n    letter-spacing: normal;\n    color: #131415;\n    padding: 13px 15px;\n  }\n</style>\n"],"sourceRoot":"src/components"}]}