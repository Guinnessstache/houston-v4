{"remainingRequest":"/Users/davidaleksic/Sites/houston-v4/node_modules/babel-loader/lib/index.js!/Users/davidaleksic/Sites/houston-v4/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/davidaleksic/Sites/houston-v4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/davidaleksic/Sites/houston-v4/src/components/Balances.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/davidaleksic/Sites/houston-v4/src/components/Balances.vue","mtime":1577116137885},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/cache-loader/dist/cjs.js","mtime":1577116124352},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/babel-loader/lib/index.js","mtime":1577116124172},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/cache-loader/dist/cjs.js","mtime":1577116124352},{"path":"/Users/davidaleksic/Sites/houston-v4/node_modules/vue-loader/lib/index.js","mtime":1577116128818}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.sub\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.object.values\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.date.to-string\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  props: ['profileStorageAddress', 'erc725', 'profileAddress', 'operationalWallet', 'tokenAddress', 'management_wallet_input', 'submitted'],\n  name: 'Balances',\n  data: function data() {\n    return {\n      ow_eth_balance: 0,\n      mw_eth_balance: 0,\n      mw_trac_balance: 0,\n      total_trac: 0,\n      locked_trac: 0,\n      minimum_stake: 0,\n      management_wallet: '',\n      total_trac_changed: false,\n      locked_trac_changed: false,\n      total_trac_increased: false,\n      total_trac_decreased: false,\n      mw_trac_balance_increased: false,\n      mw_trac_balance_decreased: false,\n      mw_eth_balance_increased: false,\n      mw_eth_balance_decreased: false,\n      ow_eth_balance_increased: false,\n      ow_eth_balance_decreased: false\n    };\n  },\n  watch: {\n    locked_trac: function locked_trac(newVal, oldVal) {\n      var _this = this;\n\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        this.locked_trac_changed = true;\n        setTimeout(function () {\n          _this.locked_trac_changed = false;\n        }, 3000);\n      } else {\n        this.locked_trac_changed = false;\n      }\n    },\n    total_trac: function total_trac(newVal, oldVal) {\n      var _this2 = this;\n\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.total_trac_increased = true;\n          setTimeout(function () {\n            _this2.total_trac_increased = false;\n          }, 3000);\n        } else {\n          this.total_trac_decreased = true;\n          setTimeout(function () {\n            _this2.total_trac_decreased = false;\n          }, 3000);\n        } // this.total_trac_changed = true;\n\n      } else {\n        this.total_trac_increased = false;\n        this.total_trac_decreased = false;\n      }\n    },\n    mw_trac_balance: function mw_trac_balance(newVal, oldVal) {\n      var _this3 = this;\n\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.mw_trac_balance_increased = true;\n          setTimeout(function () {\n            _this3.mw_trac_balance_increased = false;\n          }, 3000);\n        } else {\n          this.mw_trac_balance_decreased = true;\n          setTimeout(function () {\n            _this3.mw_trac_balance_decreased = false;\n          }, 3000);\n        }\n      } else {\n        this.mw_trac_balance_increased = false;\n        this.mw_trac_balance_decreased = false;\n      }\n    },\n    mw_eth_balance: function mw_eth_balance(newVal, oldVal) {\n      var _this4 = this;\n\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.mw_eth_balance_increased = true;\n          setTimeout(function () {\n            _this4.mw_eth_balance_increased = false;\n          }, 3000);\n        } else {\n          this.mw_eth_balance_decreased = true;\n          setTimeout(function () {\n            _this4.mw_eth_balance_decreased = false;\n          }, 3000);\n        }\n      } else {\n        this.mw_eth_balance_increased = false;\n        this.mw_eth_balance_decreased = false;\n      }\n    },\n    ow_eth_balance: function ow_eth_balance(newVal, oldVal) {\n      var _this5 = this;\n\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.ow_eth_balance_increased = true;\n          setTimeout(function () {\n            _this5.ow_eth_balance_increased = false;\n          }, 3000);\n        } else {\n          this.ow_eth_balance_decreased = true;\n          setTimeout(function () {\n            _this5.ow_eth_balance_decreased = false;\n          }, 3000);\n        }\n      } else {\n        this.ow_eth_balance_increased = false;\n        this.ow_eth_balance_decreased = false;\n      }\n    },\n    management_wallet: function management_wallet(newVal, oldVal) {\n      var _this6 = this;\n\n      var erc = window.eth.contract(window.erc725Abi).at(this.erc725);\n      var keccakContract = window.eth.contract(window.keccakAbi).at(window.keccakAddress);\n      keccakContract.keccakAddress(newVal).then(function (response) {\n        var responseArray = Object.values(response);\n        var wallet = responseArray[0];\n        erc.getKeysByPurpose(1).then(function (result) {\n          var keys = result.keys;\n          var isValid = keys.includes(wallet);\n\n          if (!isValid) {\n            _this6.$message.error({\n              message: 'This wallet is not registered as a management wallet, please change it in MetaMask!',\n              duration: 7000\n            });\n          }\n        });\n      });\n    }\n  },\n  computed: {\n    safe_to_withdraw: function safe_to_withdraw() {\n      try {\n        return this.total_trac.sub(this.locked_trac).sub(this.minimum_stake);\n      } catch (e) {\n        // console.log(e)\n        return '';\n      }\n    }\n  },\n  filters: {\n    toTrac: function toTrac(val) {\n      var am = new window.Eth.BN(val);\n      var base = new window.Eth.BN(10);\n      var exponent = new window.Eth.BN(15);\n      var multiply = base.pow(exponent);\n      return am.div(multiply).toNumber() < 0 ? 0 : am.div(multiply).toNumber() / 1000;\n    }\n  },\n  mounted: function mounted() {\n    var _this7 = this;\n\n    console.log('pozvana u balances');\n    this.getAllBalances();\n    window.EventBus.$on('loading-done', function () {\n      _this7.getAllBalances();\n    }, 5000);\n    setInterval(function () {\n      _this7.getAllBalances();\n    }, 10000);\n\n    if (screen.width <= 770 && this.management_wallet_input !== '') {\n      this.management_wallet = this.management_wallet_input;\n    }\n  },\n  methods: {\n    getAllBalances: function getAllBalances() {\n      var _this8 = this;\n\n      console.log('pozvana get balances');\n      console.log(this.operationalWallet, 'operational wallet');\n      window.eth.getBalance(this.operationalWallet).then(function (result) {\n        _this8.ow_eth_balance = Math.round(window.Eth.fromWei(result, 'ether') * 1000) / 1000;\n      }).catch(function (error) {\n        console.log(error);\n      });\n      window.eth.accounts().then(function (result) {\n        if (_this8.management_wallet_input !== '') {\n          _this8.management_wallet = _this8.management_wallet_input;\n          window.EventBus.$emit('management_wallet_changed', _this8.management_wallet);\n        } else {\n          _this8.management_wallet = result[0];\n          window.EventBus.$emit('management_wallet_changed', _this8.management_wallet);\n        }\n\n        window.eth.getBalance(_this8.management_wallet).then(function (result) {\n          _this8.mw_eth_balance = Math.round(window.Eth.fromWei(result, 'ether') * 1000) / 1000;\n        }).catch(function (error) {\n          console.log(error);\n        });\n        var tokenContract = window.eth.contract(window.tokenAbi).at(_this8.tokenAddress);\n        tokenContract.balanceOf(_this8.management_wallet).then(function (balance) {\n          _this8.mw_trac_balance = _this8.$options.filters.toTrac(balance[0].toString());\n        }).catch(function (error) {\n          console.log(error);\n        });\n      });\n      var profileStorageContract = window.eth.contract(window.profileStorageAbi).at(this.profileStorageAddress);\n      var profileContract = window.eth.contract(window.profileAbi).at(this.profileAddress);\n      profileStorageContract.getStake(this.erc725).then(function (result) {\n        console.log(result, 'rezultat get Stake');\n        _this8.total_trac = new window.Eth.BN(result[0]);\n      });\n      profileStorageContract.getStakeReserved(this.erc725).then(function (result) {\n        _this8.locked_trac = new window.Eth.BN(result[0]);\n      });\n      profileContract.minimalStake().then(function (result) {\n        _this8.minimum_stake = new window.Eth.BN(result[0]);\n      });\n    }\n  }\n};",{"version":3,"sources":["Balances.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <el-row v-bind:class=\"[\n    total_trac_increased ? 'increased' : '',\n    total_trac_decreased ? 'decreased' : '',\n    'balance-row'\n    ]\">\n      <el-col>\n        <h2 class=\"balance-headline\">ODN Node Profile</h2>\n      </el-col>\n      <el-col :span=\"12\" class=\"align-left left-text\">TOTAL</el-col>\n      <el-col :span=\"12\" class=\"result\">{{total_trac | toTrac}} TRAC</el-col>\n    </el-row>\n\n    <el-row class=\"balance-row\"\n            v-bind:class=\"[locked_trac_changed ? 'changed' : '', 'balance-row']\">\n      <el-col :span=\"12\" class=\"align-left\">LOCKED</el-col>\n      <el-col :span=\"12\" class=\"result\">{{locked_trac | toTrac}} TRAC</el-col>\n    </el-row>\n\n    <el-row class=\"balance-row\">\n      <el-col :span=\"12\" class=\"align-left\">MIN. STAKE</el-col>\n      <el-col :span=\"12\" class=\"result\">{{minimum_stake | toTrac}} TRAC</el-col>\n    </el-row>\n\n    <el-row class=\"balance-row\">\n      <el-col :span=\"12\" class=\"align-left\">SAFE TO WITHDRAW</el-col>\n      <el-col :span=\"12\" class=\"result\">{{safe_to_withdraw | toTrac}} TRAC</el-col>\n    </el-row>\n\n    <h2 class=\"balance-headline\">Operational wallet</h2>\n    <h6 class=\"address\">{{operationalWallet}}</h6>\n    <el-row class=\"balance-row\" v-bind:class=\"[\n    ow_eth_balance_increased ? 'increased' : '',\n    ow_eth_balance_decreased ? 'decreased' : '',\n    'balance-row'\n    ]\">\n      <el-col :span=\"12\" class=\"align-left\">ETH</el-col>\n      <el-col :span=\"12\" class=\"result\">{{ow_eth_balance}}</el-col>\n    </el-row>\n\n    <h2 class=\"balance-headline\">Management wallet</h2>\n    <p class=\"address\">{{management_wallet}}</p>\n    <el-row class=\"balance-row\" v-bind:class=\"[\n    mw_eth_balance_increased ? 'increased' : '',\n    mw_eth_balance_decreased ? 'decreased' : '',\n    'balance-row'\n    ]\">\n      <el-col :span=\"12\" class=\"align-left\">ETH</el-col>\n      <el-col :span=\"12\" >{{mw_eth_balance}}</el-col>\n    </el-row>\n\n    <el-row class=\"balance-row\" v-bind:class=\"[\n    mw_trac_balance_increased ? 'increased' : '',\n    mw_trac_balance_decreased ? 'decreased' : '',\n    'balance-row'\n    ]\">\n      <el-col :span=\"12\" class=\"align-left\">TRAC</el-col>\n      <el-col :span=\"12\" class=\"result\">{{mw_trac_balance}}</el-col>\n    </el-row>\n  </div>\n</template>\n<script>\nexport default {\n  props: ['profileStorageAddress', 'erc725', 'profileAddress', 'operationalWallet', 'tokenAddress', 'management_wallet_input', 'submitted'],\n  name: 'Balances',\n  data() {\n    return {\n      ow_eth_balance: 0,\n      mw_eth_balance: 0,\n      mw_trac_balance: 0,\n      total_trac: 0,\n      locked_trac: 0,\n      minimum_stake: 0,\n      management_wallet: '',\n      total_trac_changed: false,\n      locked_trac_changed: false,\n      total_trac_increased: false,\n      total_trac_decreased: false,\n      mw_trac_balance_increased: false,\n      mw_trac_balance_decreased: false,\n      mw_eth_balance_increased: false,\n      mw_eth_balance_decreased: false,\n      ow_eth_balance_increased: false,\n      ow_eth_balance_decreased: false,\n    };\n  },\n  watch: {\n    locked_trac(newVal, oldVal) {\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        this.locked_trac_changed = true;\n        setTimeout(() => {\n          this.locked_trac_changed = false;\n        }, 3000);\n      } else {\n        this.locked_trac_changed = false;\n      }\n    },\n    total_trac(newVal, oldVal) {\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.total_trac_increased = true;\n          setTimeout(() => {\n            this.total_trac_increased = false;\n          }, 3000);\n        } else {\n          this.total_trac_decreased = true;\n          setTimeout(() => {\n            this.total_trac_decreased = false;\n          }, 3000);\n        }\n        // this.total_trac_changed = true;\n      } else {\n        this.total_trac_increased = false;\n        this.total_trac_decreased = false;\n      }\n    },\n    mw_trac_balance(newVal, oldVal) {\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.mw_trac_balance_increased = true;\n          setTimeout(() => {\n            this.mw_trac_balance_increased = false;\n          }, 3000);\n        } else {\n          this.mw_trac_balance_decreased = true;\n          setTimeout(() => {\n            this.mw_trac_balance_decreased = false;\n          }, 3000);\n        }\n      } else {\n        this.mw_trac_balance_increased = false;\n        this.mw_trac_balance_decreased = false;\n      }\n    },\n    mw_eth_balance(newVal, oldVal) {\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.mw_eth_balance_increased = true;\n          setTimeout(() => {\n            this.mw_eth_balance_increased = false;\n          }, 3000);\n        } else {\n          this.mw_eth_balance_decreased = true;\n          setTimeout(() => {\n            this.mw_eth_balance_decreased = false;\n          }, 3000);\n        }\n      } else {\n        this.mw_eth_balance_increased = false;\n        this.mw_eth_balance_decreased = false;\n      }\n    },\n    ow_eth_balance(newVal, oldVal) {\n      if (newVal.toString() !== oldVal.toString() && oldVal !== 0) {\n        if (newVal.toString() > oldVal.toString()) {\n          this.ow_eth_balance_increased = true;\n          setTimeout(() => {\n            this.ow_eth_balance_increased = false;\n          }, 3000);\n        } else {\n          this.ow_eth_balance_decreased = true;\n          setTimeout(() => {\n            this.ow_eth_balance_decreased = false;\n          }, 3000);\n        }\n      } else {\n        this.ow_eth_balance_increased = false;\n        this.ow_eth_balance_decreased = false;\n      }\n    },\n    management_wallet(newVal, oldVal) {\n      const erc = window.eth.contract(window.erc725Abi).at(this.erc725);\n\n      const keccakContract = window.eth.contract(window.keccakAbi).at(window.keccakAddress);\n      keccakContract.keccakAddress(newVal).then((response) => {\n        const responseArray = Object.values(response);\n        const wallet = responseArray[0];\n\n        erc.getKeysByPurpose(1).then((result) => {\n          const keys = result.keys;\n          const isValid = keys.includes(wallet);\n\n          if (!isValid) {\n            this.$message.error({\n              message: 'This wallet is not registered as a management wallet, please change it in MetaMask!',\n              duration: 7000,\n            });\n          }\n        });\n      });\n    },\n  },\n  computed: {\n    safe_to_withdraw() {\n      try {\n        return this.total_trac.sub(this.locked_trac).sub(this.minimum_stake);\n      } catch (e) {\n        // console.log(e)\n        return '';\n      }\n    },\n  },\n  filters: {\n    toTrac(val) {\n      const am = new window.Eth.BN(val);\n      const base = new window.Eth.BN(10);\n      const exponent = new window.Eth.BN(15);\n      const multiply = base.pow(exponent);\n      return (am.div(multiply).toNumber() < 0) ? 0 : am.div(multiply).toNumber() / 1000;\n    },\n  },\n  mounted() {\n    console.log('pozvana u balances');\n    this.getAllBalances();\n    window.EventBus.$on('loading-done', () => {\n      this.getAllBalances();\n    }, 5000);\n    setInterval(() => {\n      this.getAllBalances();\n    }, 10000);\n    if (screen.width <= 770 && this.management_wallet_input !== '') {\n      this.management_wallet = this.management_wallet_input;\n    }\n  },\n  methods: {\n    getAllBalances() {\n      console.log('pozvana get balances');\n\n      console.log(this.operationalWallet, 'operational wallet');\n\n      window.eth.getBalance(this.operationalWallet)\n        .then((result) => {\n          this.ow_eth_balance = Math.round(window.Eth.fromWei(result, 'ether') * 1000) / 1000;\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n      window.eth.accounts().then((result) => {\n        if (this.management_wallet_input !== '') {\n          this.management_wallet = this.management_wallet_input;\n          window.EventBus.$emit('management_wallet_changed', this.management_wallet);\n        } else {\n          this.management_wallet = result[0];\n          window.EventBus.$emit('management_wallet_changed', this.management_wallet);\n        }\n        window.eth.getBalance(this.management_wallet)\n          .then((result) => {\n            this.mw_eth_balance = Math.round(window.Eth.fromWei(result, 'ether') * 1000) / 1000;\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n        const tokenContract = window.eth.contract(window.tokenAbi).at(this.tokenAddress);\n        tokenContract.balanceOf(this.management_wallet)\n          .then((balance) => {\n            this.mw_trac_balance = this.$options.filters.toTrac(balance[0].toString());\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n      });\n\n      const profileStorageContract = window.eth.contract(window.profileStorageAbi)\n        .at(this.profileStorageAddress);\n\n      const profileContract = window.eth.contract(window.profileAbi)\n        .at(this.profileAddress);\n\n      profileStorageContract.getStake(this.erc725).then((result) => {\n        console.log(result, 'rezultat get Stake');\n\n        this.total_trac = new window.Eth.BN(result[0]);\n      });\n\n      profileStorageContract.getStakeReserved(this.erc725).then((result) => {\n        this.locked_trac = new window.Eth.BN(result[0]);\n      });\n\n      profileContract.minimalStake().then((result) => {\n        this.minimum_stake = new window.Eth.BN(result[0]);\n      });\n    },\n  },\n};\n</script>\n<style>\n  .main-headline{\n    font-family: Roboto;\n    font-size: 46px;\n    font-weight: bold;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: 1.17;\n    letter-spacing: normal;\n    color: #131415;\n  }\n\n  .address{\n    font-family: Roboto;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: 1.75;\n    letter-spacing: normal;\n    color: #131415;\n    margin: 15px 0;\n  }\n\n  .balance-headline{\n    color: #131415;\n    font-family: Roboto;\n    font-size: 24px;\n    font-weight: bold;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: 1.33;\n    letter-spacing: normal;\n  }\n\n  .align-left {\n    text-align: left;\n    opacity: 0.5;\n    font-family: Roboto;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: 1;\n    letter-spacing: normal;\n    color: #131415;\n  }\n\n  .result{\n    font-family: Roboto;\n    font-size: 16px;\n    font-weight: 500;\n    font-stretch: normal;\n    font-style: normal;\n    line-height: 1;\n    letter-spacing: normal;\n    color: #131415;\n  }\n\n  .balance-row {\n    padding: 5px;\n    margin: 5px 0;\n    transition: 1s all;\n  }\n\n  .balance-row:nth-of-type(odd) {\n    color: white;\n  }\n\n  .balance-row div:nth-child(2) {\n    transition: 1s color;\n  }\n\n  .changed div:nth-child(2) {\n    color: red;\n    transition: 1s color;\n  }\n\n  .increased div:nth-child(2) {\n    color: #14da9e;\n    transition: 1s color;\n  }\n\n  .decreased div:nth-child(2) {\n    color: red;\n    transition: 1s color;\n  }\n\n</style>\n"],"sourceRoot":"src/components"}]}